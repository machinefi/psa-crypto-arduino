<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PSA Crypto: Key import and export</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">PSA Crypto
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Key import and export</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gad088d8ebc854d2f7a5b5c1769bc9ed40"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__error.html#ga05676e70ba5c6a7565aff3c36677c1f9">psa_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__import__export.html#gad088d8ebc854d2f7a5b5c1769bc9ed40">psa_import_key</a> (const <a class="el" href="group__attributes.html#ga8eedc0a49d58b566770c81a1a617f63e">psa_key_attributes_t</a> *attributes, const uint8_t *data, size_t data_length, <a class="el" href="group__key__lifetimes.html#ga11e986351c65bd3dc3c0fe2cd9926e4b">psa_key_id_t</a> *key)</td></tr>
<tr class="memdesc:gad088d8ebc854d2f7a5b5c1769bc9ed40"><td class="mdescLeft">&#160;</td><td class="mdescRight">Import a key in binary format.  <a href="group__import__export.html#gad088d8ebc854d2f7a5b5c1769bc9ed40">More...</a><br /></td></tr>
<tr class="separator:gad088d8ebc854d2f7a5b5c1769bc9ed40"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5f2f7c851186c5d1d928be0b6020225c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__error.html#ga05676e70ba5c6a7565aff3c36677c1f9">psa_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__import__export.html#ga5f2f7c851186c5d1d928be0b6020225c">psa_export_key</a> (<a class="el" href="group__key__lifetimes.html#ga11e986351c65bd3dc3c0fe2cd9926e4b">psa_key_id_t</a> key, uint8_t *data, size_t data_size, size_t *data_length)</td></tr>
<tr class="memdesc:ga5f2f7c851186c5d1d928be0b6020225c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Export a key in binary format.  <a href="group__import__export.html#ga5f2f7c851186c5d1d928be0b6020225c">More...</a><br /></td></tr>
<tr class="separator:ga5f2f7c851186c5d1d928be0b6020225c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga76970efac4f9418a03bf59dc345eaf88"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__error.html#ga05676e70ba5c6a7565aff3c36677c1f9">psa_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__import__export.html#ga76970efac4f9418a03bf59dc345eaf88">psa_export_public_key</a> (<a class="el" href="group__key__lifetimes.html#ga11e986351c65bd3dc3c0fe2cd9926e4b">psa_key_id_t</a> key, uint8_t *data, size_t data_size, size_t *data_length)</td></tr>
<tr class="memdesc:ga76970efac4f9418a03bf59dc345eaf88"><td class="mdescLeft">&#160;</td><td class="mdescRight">Export a public key or the public part of a key pair in binary format.  <a href="group__import__export.html#ga76970efac4f9418a03bf59dc345eaf88">More...</a><br /></td></tr>
<tr class="separator:ga76970efac4f9418a03bf59dc345eaf88"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga5f2f7c851186c5d1d928be0b6020225c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga5f2f7c851186c5d1d928be0b6020225c">&#9670;&nbsp;</a></span>psa_export_key()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__error.html#ga05676e70ba5c6a7565aff3c36677c1f9">psa_status_t</a> psa_export_key </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__key__lifetimes.html#ga11e986351c65bd3dc3c0fe2cd9926e4b">psa_key_id_t</a>&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>data_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>data_length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Export a key in binary format. </p>
<p>The output of this function can be passed to <a class="el" href="group__import__export.html#gad088d8ebc854d2f7a5b5c1769bc9ed40" title="Import a key in binary format.">psa_import_key()</a> to create an equivalent object.</p>
<p>If the implementation of <a class="el" href="group__import__export.html#gad088d8ebc854d2f7a5b5c1769bc9ed40" title="Import a key in binary format.">psa_import_key()</a> supports other formats beyond the format specified here, the output from <a class="el" href="group__import__export.html#ga5f2f7c851186c5d1d928be0b6020225c" title="Export a key in binary format.">psa_export_key()</a> must use the representation specified here, not the original representation.</p>
<p>For standard key types, the output format is as follows:</p>
<ul>
<li>For symmetric keys (including MAC keys), the format is the raw bytes of the key.</li>
<li>For DES, the key data consists of 8 bytes. The parity bits must be correct.</li>
<li>For Triple-DES, the format is the concatenation of the two or three DES keys.</li>
<li>For RSA key pairs (<a class="el" href="group__crypto__types.html#ga11745b110166e927e2abeabc7d532051">PSA_KEY_TYPE_RSA_KEY_PAIR</a>), the format is the non-encrypted DER encoding of the representation defined by PKCS#1 (RFC 8017) as <code>RSAPrivateKey</code>, version 0. <div class="fragment"><div class="line">RSAPrivateKey ::= SEQUENCE {</div>
<div class="line">    version             INTEGER,  -- must be 0</div>
<div class="line">    modulus             INTEGER,  -- n</div>
<div class="line">    publicExponent      INTEGER,  -- e</div>
<div class="line">    privateExponent     INTEGER,  -- d</div>
<div class="line">    prime1              INTEGER,  -- p</div>
<div class="line">    prime2              INTEGER,  -- q</div>
<div class="line">    exponent1           INTEGER,  -- d mod (p-1)</div>
<div class="line">    exponent2           INTEGER,  -- d mod (q-1)</div>
<div class="line">    coefficient         INTEGER,  -- (inverse of q) mod p</div>
<div class="line">}</div>
</div><!-- fragment --></li>
<li>For elliptic curve key pairs (key types for which <a class="el" href="group__crypto__types.html#gab00289ec3d84a469950a4d8c10fb8cc6">PSA_KEY_TYPE_IS_ECC_KEY_PAIR</a> is true), the format is a representation of the private value as a <code>ceiling(m/8)</code>-byte string where <code>m</code> is the bit size associated with the curve, i.e. the bit size of the order of the curve's coordinate field. This byte string is in little-endian order for Montgomery curves (curve types <code>PSA_ECC_FAMILY_CURVEXXX</code>), and in big-endian order for Weierstrass curves (curve types <code>PSA_ECC_FAMILY_SECTXXX</code>, <code>PSA_ECC_FAMILY_SECPXXX</code> and <code>PSA_ECC_FAMILY_BRAINPOOL_PXXX</code>). For Weierstrass curves, this is the content of the <code>privateKey</code> field of the <code>ECPrivateKey</code> format defined by RFC 5915. For Montgomery curves, the format is defined by RFC 7748, and output is masked according to ยง5. For twisted Edwards curves, the private key is as defined by RFC 8032 (a 32-byte string for Edwards25519, a 57-byte string for Edwards448).</li>
<li>For Diffie-Hellman key exchange key pairs (key types for which <a class="el" href="group__crypto__types.html#gabb9dd614786fe328df4e485c1a61ed25">PSA_KEY_TYPE_IS_DH_KEY_PAIR</a> is true), the format is the representation of the private key <code>x</code> as a big-endian byte string. The length of the byte string is the private key size in bytes (leading zeroes are not stripped).</li>
<li>For public keys (key types for which <a class="el" href="group__crypto__types.html#gac674a0f059bc0cb72b47f0c517b4f45b">PSA_KEY_TYPE_IS_PUBLIC_KEY</a> is true), the format is the same as for <a class="el" href="group__import__export.html#ga76970efac4f9418a03bf59dc345eaf88" title="Export a public key or the public part of a key pair in binary format.">psa_export_public_key()</a>.</li>
</ul>
<p>The policy on the key must have the usage flag <a class="el" href="group__policy.html#ga7dddccdd1303176e87a4d20c87b589ed">PSA_KEY_USAGE_EXPORT</a> set.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">key</td><td>Identifier of the key to export. It must allow the usage <a class="el" href="group__policy.html#ga7dddccdd1303176e87a4d20c87b589ed">PSA_KEY_USAGE_EXPORT</a>, unless it is a public key. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">data</td><td>Buffer where the key data is to be written. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">data_size</td><td>Size of the <code>data</code> buffer in bytes. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">data_length</td><td>On success, the number of bytes that make up the key data.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="group__error.html#ga4cc859e2c66ca381c7418db3527a65e1">PSA_SUCCESS</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#gadf22718935657c2c3168c228204085f9">PSA_ERROR_INVALID_HANDLE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga4d1b8dd8526177a15a210b7afc1accb1">PSA_ERROR_NOT_PERMITTED</a></td><td>The key does not have the <a class="el" href="group__policy.html#ga7dddccdd1303176e87a4d20c87b589ed">PSA_KEY_USAGE_EXPORT</a> flag. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga1dcc6d130633ed5db8942257581b55dd">PSA_ERROR_NOT_SUPPORTED</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga695025f4ec11249aee7ea3d0f65e01c8">PSA_ERROR_BUFFER_TOO_SMALL</a></td><td>The size of the <code>data</code> buffer is too small. You can determine a sufficient buffer size by calling <a class="el" href="psa_2crypto__sizes_8h.html#a2e3ff71b9f4e639c03c9e55c7774dc51">PSA_EXPORT_KEY_OUTPUT_SIZE</a>(<code>type</code>, <code>bits</code>) where <code>type</code> is the key type and <code>bits</code> is the key size in bits. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga5cdb6948371d49e916106249020ea3f7">PSA_ERROR_COMMUNICATION_FAILURE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga08b10e70fa5ff0b05c631d9f8f6b2c6b">PSA_ERROR_HARDWARE_FAILURE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga116f4d4c6a9d9db3397991a8472d8950">PSA_ERROR_CORRUPTION_DETECTED</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#gadd169a1af2707862b95fb9df91dfc37d">PSA_ERROR_STORAGE_FAILURE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga91b2ad8a867517a2651f1b076c5216e5">PSA_ERROR_INSUFFICIENT_MEMORY</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga933d40fa2a591004f2e93aa91e11db84">PSA_ERROR_BAD_STATE</a></td><td>The library has not been previously initialized by <a class="el" href="group__initialization.html#ga2de150803fc2f7dc6101d5af7e921dd9" title="Library initialization.">psa_crypto_init()</a>. It is implementation-dependent whether a failure to initialize results in this error code. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga76970efac4f9418a03bf59dc345eaf88"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga76970efac4f9418a03bf59dc345eaf88">&#9670;&nbsp;</a></span>psa_export_public_key()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__error.html#ga05676e70ba5c6a7565aff3c36677c1f9">psa_status_t</a> psa_export_public_key </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__key__lifetimes.html#ga11e986351c65bd3dc3c0fe2cd9926e4b">psa_key_id_t</a>&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>data_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>data_length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Export a public key or the public part of a key pair in binary format. </p>
<p>The output of this function can be passed to <a class="el" href="group__import__export.html#gad088d8ebc854d2f7a5b5c1769bc9ed40" title="Import a key in binary format.">psa_import_key()</a> to create an object that is equivalent to the public key.</p>
<p>This specification supports a single format for each key type. Implementations may support other formats as long as the standard format is supported. Implementations that support other formats should ensure that the formats are clearly unambiguous so as to minimize the risk that an invalid input is accidentally interpreted according to a different format.</p>
<p>For standard key types, the output format is as follows:</p><ul>
<li>For RSA public keys (<a class="el" href="group__crypto__types.html#ga9ba0878f56c8bcd1995ac017a74f513b">PSA_KEY_TYPE_RSA_PUBLIC_KEY</a>), the DER encoding of the representation defined by RFC 3279 &sect;2.3.1 as <code>RSAPublicKey</code>. <div class="fragment"><div class="line">RSAPublicKey ::= SEQUENCE {</div>
<div class="line">   modulus            INTEGER,    -- n</div>
<div class="line">   publicExponent     INTEGER  }  -- e</div>
</div><!-- fragment --></li>
<li>For elliptic curve keys on a twisted Edwards curve (key types for which <a class="el" href="group__crypto__types.html#ga5af146a173b0c84d7e737e2fb6a3c0a7">PSA_KEY_TYPE_IS_ECC_PUBLIC_KEY</a> is true and <a class="el" href="group__crypto__types.html#ga30642b7e640a6e9e00871764afe0288d">PSA_KEY_TYPE_ECC_GET_FAMILY</a> returns <a class="el" href="group__crypto__types.html#gafe45f9fe29699f26795f6251f47eafd4">PSA_ECC_FAMILY_TWISTED_EDWARDS</a>), the public key is as defined by RFC 8032 (a 32-byte string for Edwards25519, a 57-byte string for Edwards448).</li>
<li>For other elliptic curve public keys (key types for which <a class="el" href="group__crypto__types.html#ga5af146a173b0c84d7e737e2fb6a3c0a7">PSA_KEY_TYPE_IS_ECC_PUBLIC_KEY</a> is true), the format is the uncompressed representation defined by SEC1 &sect;2.3.3 as the content of an ECPoint. Let <code>m</code> be the bit size associated with the curve, i.e. the bit size of <code>q</code> for a curve over <code>F_q</code>. The representation consists of:<ul>
<li>The byte 0x04;</li>
<li><code>x_P</code> as a <code>ceiling(m/8)</code>-byte string, big-endian;</li>
<li><code>y_P</code> as a <code>ceiling(m/8)</code>-byte string, big-endian.</li>
</ul>
</li>
<li>For Diffie-Hellman key exchange public keys (key types for which <a class="el" href="group__crypto__types.html#ga23627e047fa4b536f07d6f4796f879f5">PSA_KEY_TYPE_IS_DH_PUBLIC_KEY</a> is true), the format is the representation of the public key <code>y = g^x mod p</code> as a big-endian byte string. The length of the byte string is the length of the base prime <code>p</code> in bytes.</li>
</ul>
<p>Exporting a public key object or the public part of a key pair is always permitted, regardless of the key's usage flags.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">key</td><td>Identifier of the key to export. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">data</td><td>Buffer where the key data is to be written. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">data_size</td><td>Size of the <code>data</code> buffer in bytes. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">data_length</td><td>On success, the number of bytes that make up the key data.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="group__error.html#ga4cc859e2c66ca381c7418db3527a65e1">PSA_SUCCESS</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#gadf22718935657c2c3168c228204085f9">PSA_ERROR_INVALID_HANDLE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga798df25a505ebf931f7bec1f80f1f85f">PSA_ERROR_INVALID_ARGUMENT</a></td><td>The key is neither a public key nor a key pair. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga1dcc6d130633ed5db8942257581b55dd">PSA_ERROR_NOT_SUPPORTED</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga695025f4ec11249aee7ea3d0f65e01c8">PSA_ERROR_BUFFER_TOO_SMALL</a></td><td>The size of the <code>data</code> buffer is too small. You can determine a sufficient buffer size by calling <a class="el" href="psa_2crypto__sizes_8h.html#a2e3ff71b9f4e639c03c9e55c7774dc51">PSA_EXPORT_KEY_OUTPUT_SIZE</a>(<a class="el" href="group__crypto__types.html#ga679be3d789cfa0c1fd8418764ff754b1">PSA_KEY_TYPE_PUBLIC_KEY_OF_KEY_PAIR</a>(<code>type</code>), <code>bits</code>) where <code>type</code> is the key type and <code>bits</code> is the key size in bits. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga5cdb6948371d49e916106249020ea3f7">PSA_ERROR_COMMUNICATION_FAILURE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga08b10e70fa5ff0b05c631d9f8f6b2c6b">PSA_ERROR_HARDWARE_FAILURE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga116f4d4c6a9d9db3397991a8472d8950">PSA_ERROR_CORRUPTION_DETECTED</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#gadd169a1af2707862b95fb9df91dfc37d">PSA_ERROR_STORAGE_FAILURE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga91b2ad8a867517a2651f1b076c5216e5">PSA_ERROR_INSUFFICIENT_MEMORY</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga933d40fa2a591004f2e93aa91e11db84">PSA_ERROR_BAD_STATE</a></td><td>The library has not been previously initialized by <a class="el" href="group__initialization.html#ga2de150803fc2f7dc6101d5af7e921dd9" title="Library initialization.">psa_crypto_init()</a>. It is implementation-dependent whether a failure to initialize results in this error code. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gad088d8ebc854d2f7a5b5c1769bc9ed40"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gad088d8ebc854d2f7a5b5c1769bc9ed40">&#9670;&nbsp;</a></span>psa_import_key()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__error.html#ga05676e70ba5c6a7565aff3c36677c1f9">psa_status_t</a> psa_import_key </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="group__attributes.html#ga8eedc0a49d58b566770c81a1a617f63e">psa_key_attributes_t</a> *&#160;</td>
          <td class="paramname"><em>attributes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>data_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__key__lifetimes.html#ga11e986351c65bd3dc3c0fe2cd9926e4b">psa_key_id_t</a> *&#160;</td>
          <td class="paramname"><em>key</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Import a key in binary format. </p>
<p>This function supports any output from <a class="el" href="group__import__export.html#ga5f2f7c851186c5d1d928be0b6020225c" title="Export a key in binary format.">psa_export_key()</a>. Refer to the documentation of <a class="el" href="group__import__export.html#ga76970efac4f9418a03bf59dc345eaf88" title="Export a public key or the public part of a key pair in binary format.">psa_export_public_key()</a> for the format of public keys and to the documentation of <a class="el" href="group__import__export.html#ga5f2f7c851186c5d1d928be0b6020225c" title="Export a key in binary format.">psa_export_key()</a> for the format for other key types.</p>
<p>The key data determines the key size. The attributes may optionally specify a key size; in this case it must match the size determined from the key data. A key size of 0 in <code>attributes</code> indicates that the key size is solely determined by the key data.</p>
<p>Implementations must reject an attempt to import a key of size 0.</p>
<p>This specification supports a single format for each key type. Implementations may support other formats as long as the standard format is supported. Implementations that support other formats should ensure that the formats are clearly unambiguous so as to minimize the risk that an invalid input is accidentally interpreted according to a different format.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">attributes</td><td>The attributes for the new key. The key size is always determined from the <code>data</code> buffer. If the key size in <code>attributes</code> is nonzero, it must be equal to the size from <code>data</code>. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">key</td><td>On success, an identifier to the newly created key. For persistent keys, this is the key identifier defined in <code>attributes</code>. <code>0</code> on failure. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">data</td><td>Buffer containing the key data. The content of this buffer is interpreted according to the type declared in <code>attributes</code>. All implementations must support at least the format described in the documentation of <a class="el" href="group__import__export.html#ga5f2f7c851186c5d1d928be0b6020225c" title="Export a key in binary format.">psa_export_key()</a> or <a class="el" href="group__import__export.html#ga76970efac4f9418a03bf59dc345eaf88" title="Export a public key or the public part of a key pair in binary format.">psa_export_public_key()</a> for the chosen type. Implementations may allow other formats, but should be conservative: implementations should err on the side of rejecting content if it may be erroneous (e.g. wrong type or truncated data). </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">data_length</td><td>Size of the <code>data</code> buffer in bytes.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="group__error.html#ga4cc859e2c66ca381c7418db3527a65e1">PSA_SUCCESS</a></td><td>Success. If the key is persistent, the key material and the key's metadata have been saved to persistent storage. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#gaf2b34cc87edc72f3ba90071a08210d20">PSA_ERROR_ALREADY_EXISTS</a></td><td>This is an attempt to create a persistent key, and there is already a persistent key with the given identifier. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga1dcc6d130633ed5db8942257581b55dd">PSA_ERROR_NOT_SUPPORTED</a></td><td>The key type or key size is not supported, either by the implementation in general or in this particular persistent location. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga798df25a505ebf931f7bec1f80f1f85f">PSA_ERROR_INVALID_ARGUMENT</a></td><td>The key attributes, as a whole, are invalid. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga798df25a505ebf931f7bec1f80f1f85f">PSA_ERROR_INVALID_ARGUMENT</a></td><td>The key data is not correctly formatted. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga798df25a505ebf931f7bec1f80f1f85f">PSA_ERROR_INVALID_ARGUMENT</a></td><td>The size in <code>attributes</code> is nonzero and does not match the size of the key data. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga91b2ad8a867517a2651f1b076c5216e5">PSA_ERROR_INSUFFICIENT_MEMORY</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga897a45eb206a6f6b7be7ffbe36f0d766">PSA_ERROR_INSUFFICIENT_STORAGE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga5cdb6948371d49e916106249020ea3f7">PSA_ERROR_COMMUNICATION_FAILURE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga9febb81a44bdeb4c6c42bf4f697b13bf">PSA_ERROR_DATA_CORRUPT</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#gacebfbd25a7c2a727694fb57182a66533">PSA_ERROR_DATA_INVALID</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#gadd169a1af2707862b95fb9df91dfc37d">PSA_ERROR_STORAGE_FAILURE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga08b10e70fa5ff0b05c631d9f8f6b2c6b">PSA_ERROR_HARDWARE_FAILURE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga116f4d4c6a9d9db3397991a8472d8950">PSA_ERROR_CORRUPTION_DETECTED</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga933d40fa2a591004f2e93aa91e11db84">PSA_ERROR_BAD_STATE</a></td><td>The library has not been previously initialized by <a class="el" href="group__initialization.html#ga2de150803fc2f7dc6101d5af7e921dd9" title="Library initialization.">psa_crypto_init()</a>. It is implementation-dependent whether a failure to initialize results in this error code.</td></tr>
  </table>
  </dd>
</dl>
<p>This function supports any output from <a class="el" href="group__import__export.html#ga5f2f7c851186c5d1d928be0b6020225c" title="Export a key in binary format.">psa_export_key()</a>. Refer to the documentation of <a class="el" href="group__import__export.html#ga76970efac4f9418a03bf59dc345eaf88" title="Export a public key or the public part of a key pair in binary format.">psa_export_public_key()</a> for the format of public keys and to the documentation of <a class="el" href="group__import__export.html#ga5f2f7c851186c5d1d928be0b6020225c" title="Export a key in binary format.">psa_export_key()</a> for the format for other key types.</p>
<p>The key data determines the key size. The attributes may optionally specify a key size; in this case it must match the size determined from the key data. A key size of 0 in <code>attributes</code> indicates that the key size is solely determined by the key data.</p>
<p>Implementations must reject an attempt to import a key of size 0.</p>
<p>This specification supports a single format for each key type. Implementations may support other formats as long as the standard format is supported. Implementations that support other formats should ensure that the formats are clearly unambiguous so as to minimize the risk that an invalid input is accidentally interpreted according to a different format.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">attributes</td><td>The attributes for the new key. The key size is always determined from the <code>data</code> buffer. If the key size in <code>attributes</code> is nonzero, it must be equal to the size from <code>data</code>. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">key</td><td>On success, an identifier to the newly created key. For persistent keys, this is the key identifier defined in <code>attributes</code>. <code>0</code> on failure. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">data</td><td>Buffer containing the key data. The content of this buffer is interpreted according to the type declared in <code>attributes</code>. All implementations must support at least the format described in the documentation of <a class="el" href="group__import__export.html#ga5f2f7c851186c5d1d928be0b6020225c" title="Export a key in binary format.">psa_export_key()</a> or <a class="el" href="group__import__export.html#ga76970efac4f9418a03bf59dc345eaf88" title="Export a public key or the public part of a key pair in binary format.">psa_export_public_key()</a> for the chosen type. Implementations may allow other formats, but should be conservative: implementations should err on the side of rejecting content if it may be erroneous (e.g. wrong type or truncated data). </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">data_length</td><td>Size of the <code>data</code> buffer in bytes.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="group__error.html#ga4cc859e2c66ca381c7418db3527a65e1">PSA_SUCCESS</a></td><td>Success. If the key is persistent, the key material and the key's metadata have been saved to persistent storage. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#gaf2b34cc87edc72f3ba90071a08210d20">PSA_ERROR_ALREADY_EXISTS</a></td><td>This is an attempt to create a persistent key, and there is already a persistent key with the given identifier. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga1dcc6d130633ed5db8942257581b55dd">PSA_ERROR_NOT_SUPPORTED</a></td><td>The key type or key size is not supported, either by the implementation in general or in this particular persistent location. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga798df25a505ebf931f7bec1f80f1f85f">PSA_ERROR_INVALID_ARGUMENT</a></td><td>The key attributes, as a whole, are invalid, or the key data is not correctly formatted, or the size in <code>attributes</code> is nonzero and does not match the size of the key data. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga91b2ad8a867517a2651f1b076c5216e5">PSA_ERROR_INSUFFICIENT_MEMORY</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga897a45eb206a6f6b7be7ffbe36f0d766">PSA_ERROR_INSUFFICIENT_STORAGE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga5cdb6948371d49e916106249020ea3f7">PSA_ERROR_COMMUNICATION_FAILURE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga9febb81a44bdeb4c6c42bf4f697b13bf">PSA_ERROR_DATA_CORRUPT</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#gacebfbd25a7c2a727694fb57182a66533">PSA_ERROR_DATA_INVALID</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#gadd169a1af2707862b95fb9df91dfc37d">PSA_ERROR_STORAGE_FAILURE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga08b10e70fa5ff0b05c631d9f8f6b2c6b">PSA_ERROR_HARDWARE_FAILURE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga116f4d4c6a9d9db3397991a8472d8950">PSA_ERROR_CORRUPTION_DETECTED</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga933d40fa2a591004f2e93aa91e11db84">PSA_ERROR_BAD_STATE</a></td><td>The library has not been previously initialized by <a class="el" href="group__initialization.html#ga2de150803fc2f7dc6101d5af7e921dd9" title="Library initialization.">psa_crypto_init()</a>. It is implementation-dependent whether a failure to initialize results in this error code. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
